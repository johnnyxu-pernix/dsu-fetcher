# DSU Fetcher

[![CircleCI](https://circleci.com/gh/johnnyxu-pernix/dsu-fetcher/tree/develop.svg?style=svg&circle-token=e8ccb69431c5d15d5905e348f5955c42b0bfdc01)](https://circleci.com/gh/johnnyxu-pernix/dsu-fetcher/tree/develop)

NodeJS app with the purpose of fetching messages from Slack from a specific channel and putting them into a Drive Document.

## Requisites
- NodeJS

## Setup
Install the dependencies with the following command:
```
npm install
```

## Running the project
```
node server.js
```

## Running tests
```
npm run test
```

## Environment variables
- `SLACK_TOKEN`

  It can be generated by creating an Slack application in https://api.slack.com/apps/ . Inside the 'Install App' section.

  ![Slack Token](images/slack-api.png?raw=true "Slack API")

- `CHANNEL_ID`

  Channel id from Slack, you can get it by opening Slack in the browser and opening the channel.

  ![Slack Token](images/slack-channel-id.png?raw=true "Slack channel")

- `GOOGLE_SPREADSHEET_ID`

  Google Drive's spreadsheet id, it's present in the url of the file.

  ![Drive Spreadsheet ID](images/drive-spreadsheet-id.png?raw=true "Drive Spreadsheet ID")

- `GOOGLE_APP_PRIVATE_KEY`

  • Go to the Google Developers Console

  • Select your project or create a new one (and then select it)

  • Enable the Drive API for your project

  • In the sidebar on the left, expand APIs & auth > APIs

  • Search for "drive"

  • Click on "Drive API"

  • click the blue "Enable API" button

  • Create a service account for your project

  • In the sidebar on the left, expand APIs & auth > Credentials

  • Click blue "Add credentials" button

  • Select the "Service account" option

  • Select "Furnish a new private key" checkbox

  • Select the "JSON" key type option

  • Click blue "Create" button

  • Your JSON key file is generated and downloaded to your machine (it is the only copy!) note your service account's email address (also available in the JSON key file).

  • Share the doc (or docs) with your service account using the email noted above.

  ![Drive Private Key](images/drive-private_key.png?raw=true "Drive Private Key")

- `GOOGLE_APP_MAIL`

  In the same json file you can find Google's App email.

  ![Drive Private Key](images/drive-email.png?raw=true "Drive Private Key")
